syntax = "proto3";
package pb;

service GueryMaster {
	rpc SendHeartbeat(stream Heartbeat) returns (Empty) {}
}

service GueryExecutor {
	rpc Quit(Empty) returns (Empty) {}
	rpc Duplicate(Empty) returns (Empty) {}	
	rpc SendInstruction(Instruction) returns (Empty) {}
	rpc SetupWriters(Empty) returns (Empty) {}
	rpc SetupReaders(Empty) returns (Empty) {}
	rpc Run(Empty) returns (Empty) {}
	rpc GetOutputChannelLocation(Location) returns (Location) {}
}

message Empty{}

message Location {
	string name = 1;
	string address = 2;
	int32 port = 3;
	int32 channelIndex = 4;
}

message Heartbeat {
	Location location = 1;
	int32 status = 2; //0: idle; 1:busy; 
	Instruction instruction = 3;
}

message Instruction {
	int64 taskId = 1;
	int32 taskType = 2;
	string catalog = 3;
	string schema = 4;
	string encodedEPlanNodeBytes = 5;
}
